<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>VR Mini Game</title>

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
  </head>
  <body>
    <a-scene physics="debug: true; gravity: -9.8;">

      <!-- Физическая система -->
      <a-entity physics="useWorker: true; fps: 60;"></a-entity>

      <a-sky src="yt.jpg"></a-sky>

      <!-- Пол с явными физическими свойствами -->
      <a-plane position="0 0 -4" rotation="-90 0 0" width="100" height="100"
               static-body="shape: plane; mass: 0"></a-plane>

      <!-- Камера с физическим телом -->
      <a-entity camera look-controls wasd-controls position="0 1.6 0"
                kinematic-body>
        <a-cursor color="black" fuse="true" fuse-timeout="500"></a-cursor>
      </a-entity>

      <!-- Кастомные физические объекты -->
      <a-entity class="collectible-box" position="-6 5 -3" 
                dynamic-body="mass: 1; shape: box; linearDamping: 0.05">
        <a-box color="#4CC3D9"></a-box>
      </a-entity>

      <!-- Повторить для других кубов -->
      <a-entity class="collectible-box" position="5 5 -2"
                dynamic-body="mass: 1; shape: box; linearDamping: 0.05">
        <a-box color="#4CC3D9"></a-box>
      </a-entity>

      <!-- ... остальные кубы ... -->

      <!-- Остальные элементы интерфейса -->
    </a-scene>

    <script>
      // Инициализация физических свойств
      AFRAME.registerComponent('physics-init', {
        init: function() {
          this.el.addEventListener('body-loaded', (e) => {
            const body = this.el.body;
            // Настройка физических параметров
            body.linearDamping = 0.1;
            body.angularDamping = 0.1;
            body.material = new CANNON.Material();
          });
        }
      });

      // Логика сбора объектов
      AFRAME.registerComponent('collectible', {
        init: function() {
          this.el.addEventListener('click', () => {
            // Физическое удаление объекта
            this.el.body.velocity.set(0, 0, 0);
            this.el.parentNode.removeChild(this.el);
            
            // Обновление счета
            const scoreEl = document.querySelector('#score');
            scoreEl.setAttribute('value', `Score: ${++window.score}`);
          });
        }
      });

      // Инициализация глобальных переменных
      window.score = 0;
      let timeLeft = 30;

      // Таймер
      const timerUpdate = () => {
        const timerEl = document.querySelector('#timer');
        timerEl.setAttribute('value', `Time: ${timeLeft--}`);
        if(timeLeft <= 0) endGame();
      };
      setInterval(timerUpdate, 1000);

      function endGame() {
        // Остановка физического движка
        document.querySelector('a-scene').systems.physics.pause();
        document.querySelector('#gameOverText').setAttribute('value', 
          `Final Score: ${window.score}`);
      }
    </script>
  </body>
</html>
