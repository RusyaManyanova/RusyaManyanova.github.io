<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>VR Mini Game</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.146.0/build/three.min.js"></script>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
  </head> 
  <body>
    <a-scene physics="debug: true; gravity: -9.8; inspector: true;">
      
      <!-- Физическая среда -->
      <a-entity physics="useWorker: false; fps: 60;"></a-entity>
      
      <a-sky src="yt.jpg"></a-sky>
      
      <!-- Пол с явным указанием физических свойств -->
      <a-plane position="0 0 -4" 
               rotation="-90 0 0" 
               width="100" 
               height="100" 
               static-body="shape: plane; mass: 0"></a-plane>
      
      <!-- Камера с физическим телом -->
      <a-entity camera look-controls wasd-controls 
                position="0 1.6 0"
                kinematic-body>
        <a-cursor color="black" fuse="true" fuse-timeout="500"></a-cursor>
      </a-entity>

      <!-- Объекты с кастомными физическими свойствами -->
      <a-box position="-6 5 -3" 
             color="#4CC3D9" 
             collectible 
             dynamic-body="mass: 2; shape: box; linearDamping: 0.1; angularDamping: 0.1">
      </a-box>
      
      <!-- Аналогично для остальных объектов -->
      <a-box position="5 5 -2" color="#4CC3D9" collectible 
             dynamic-body="mass: 2; shape: box"></a-box>
      <!-- ... остальные боксы ... -->

      <!-- Остальные элементы интерфейса -->
    </a-scene>

    <script>
      AFRAME.registerComponent('collectible', {
        init: function() {
          const el = this.el;
          
          // Инициализация физических свойств
          el.addEventListener('body-loaded', () => {
            const body = el.body;
            body.linearDamping = 0.1;
            body.angularDamping = 0.1;
          });

          // Логика сбора
          el.addEventListener('click', () => {
            // Физическое удаление
            el.body.velocity.set(0, 0, 0);
            el.parentNode.removeChild(el);
            
            // Обновление счета
            const scoreEl = document.querySelector('#score');
            scoreEl.setAttribute('value', `Score: ${++window.score}`);
          });
        }
      });

      // Инициализация глобальных переменных
      window.score = 0;
      let timeLeft = 30;

      // Таймер
      const timerUpdate = () => {
        const timerEl = document.querySelector('#timer');
        timerEl.setAttribute('value', `Time: ${timeLeft--}`);
        if(timeLeft <= 0) endGame();
      };
      setInterval(timerUpdate, 1000);

      function endGame() {
        // Физическая пауза
        document.querySelector('a-scene').systems.physics.pause();
        // Вывод результата
        document.querySelector('#gameOverText').setAttribute('value', 
          `Final Score: ${window.score}\nReload page to restart`);
      }
    </script>
  </body>
</html>
